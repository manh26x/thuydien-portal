<p-panel header="{{'kpi.info' | translate}}">
  <div class="split-horizontal-no-line"></div>
  <aw-kpi-info [kpiData]="kpiData"></aw-kpi-info>

  <h5 class="p-text-bold">{{'kpi.detail' | translate}}</h5>
  <aw-kpi-filter [areaList]="areaList" (filter)="doFilter($event)"></aw-kpi-filter>
  <p-table #tableKpi [value]="kpiAreaList"
           [paginator]="true"
           [rows]="10"
           [totalRecords]="kpiAreaList.length"
           [rowsPerPageOptions]="[10, 20, 50, 100]"
           [showCurrentPageReport]="true"
           currentPageReportTemplate="{{ 'paging' | translate }}">
    <ng-template pTemplate="header">
      <tr>
        <th style="width: 50px;">{{'no' | translate}}</th>
        <th>{{'kpi.indexList' | translate}}</th>
        <th>{{'kpi.area' | translate}}</th>
        <th>{{'kpi.isTargetGroup' | translate}}</th>
        <th>{{'kpi.chooseTargetGroup' | translate}}</th>
        <th>{{'kpi.allowDisplay' | translate}}</th>
      </tr>
    </ng-template>
    <ng-template pTemplate="body" let-item let-i="rowIndex">
      <tr >
        <td>{{i + 1}}</td>
        <td pEditableColumn>
          <p-cellEditor>
            <ng-template pTemplate="input">
              <input style="width: 100%;" pInputText type="text" [(ngModel)]="item.value">
            </ng-template>
            <ng-template pTemplate="output">
              {{item.value}}
            </ng-template>
          </p-cellEditor>
        </td>
        <td pEditableColumn>
          <p-cellEditor>
            <ng-template pTemplate="output">
              <ng-container *ngIf="item.area.id else notArea">
                <i class="pi pi-circle-on" [ngStyle]="{'color': item.area?.color}"></i>
                {{item.area?.name}}
              </ng-container>
              <ng-template #notArea>
                -
              </ng-template>
            </ng-template>
          </p-cellEditor>
        </td>
        <td>
          <p-checkbox [(ngModel)]="item.isMainIndex" [binary]="true"
                      [readonly]="true"></p-checkbox>
        </td>
        <td pEditableColumn>
          <p-cellEditor *ngIf="!item.isMainIndex">
            <ng-template pTemplate="output">
              <ng-container  *ngIf="item.targetGroup else notTarget">
                {{item.targetGroup}}
              </ng-container>
              <ng-template #notTarget>-</ng-template>
            </ng-template>
          </p-cellEditor>
        </td>
        <td>
          <p-checkbox [(ngModel)]="item.isShow" [binary]="true" [readonly]="true"></p-checkbox>
        </td>
      </tr>
    </ng-template>

    <ng-template pTemplate="emptymessage">
      <tr>
        <td [attr.colspan]="5">
          {{'noData' | translate}}
        </td>
      </tr>
    </ng-template>

    <ng-template pTemplate="emptymessage">
      <tr>
        <td [attr.colspan]="5">
          {{'noData' | translate}}
        </td>
      </tr>
    </ng-template>
  </p-table>

  <div class="p-text-right p-mt-3">
    <button (click)="gotoReport()" pButton label="{{'btn.back' | translate}}" class="p-button-secondary"></button>
  </div>
</p-panel>
